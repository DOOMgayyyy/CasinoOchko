<?php

/**
 * –¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–≥—Ä–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤ Casino Ochko
 * 
 * –≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏
 * —Ä–∞–±–æ—Ç—ã –∫–ª–∞—Å—Å–æ–≤ Card, Deck –∏ gameLogic, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ –∏–≥—Ä–µ –û—á–∫–æ.
 * 
 * –¢–µ—Å—Ç–∏—Ä—É–µ–º–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
 * - –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ª–æ–¥—ã –∏–∑ 52 –∫–∞—Ä—Ç
 * - –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ –∫–æ–ª–æ–¥—ã
 * - –†–∞–∑–¥–∞—á–∞ –∫–∞—Ä—Ç –∏–∑ –∫–æ–ª–æ–¥—ã
 * - –†–∞—Å—á–µ—Ç –æ—á–∫–æ–≤ —Ä—É–∫–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ç—É–∑–æ–≤
 * - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª—ç–∫–¥–∂–µ–∫–∞ –∏ –ø–µ—Ä–µ–±–æ—Ä–∞
 * 
 * –ó–∞–ø—É—Å–∫: http://localhost:8888/server/api/application/game/test.php
 * 
 * @requires MAMP –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä —Å PHP
 */

# –í–∫–ª—é—á–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
error_reporting(E_ALL);
ini_set('display_errors', 1);

// –ü–æ–¥–∫–ª—é—á–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–ª–∞—Å—Å—ã
require_once('Card.php');      # –ö–ª–∞—Å—Å –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç—ã
require_once('Deck.php');      # –ö–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–ª–æ–¥–æ–π –∫–∞—Ä—Ç
require_once('gameLogic.php'); # –ö–ª–∞—Å—Å —Å –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–æ–π

?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–¢–µ—Å—Ç –∏–≥—Ä–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>

<h1>üÉè –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤</h1>

<div class="test-section">
    <h2>–¢–µ—Å—Ç 1: var_dump –Ω–æ–≤–æ–π –∫–æ–ª–æ–¥—ã (52 –∫–∞—Ä—Ç—ã)</h2>
    <?php
    /**
     * –¢–ï–°–¢ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª–Ω–æ–π –∫–æ–ª–æ–¥—ã
     * 
     * –¶–µ–ª—å: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ Deck —Å–æ–∑–¥–∞–µ—Ç—Å—è
     * –ø–æ–ª–Ω–∞—è –∫–æ–ª–æ–¥–∞ –∏–∑ 52 –∫–∞—Ä—Ç (4 –º–∞—Å—Ç–∏ √ó 13 —Ä–∞–Ω–≥–æ–≤).
     * 
     * –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 52 –∫–∞—Ä—Ç—ã –≤ –∫–æ–ª–æ–¥–µ
     */
    $deck = new Deck();
    echo "<p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç –≤ –Ω–æ–≤–æ–π –∫–æ–ª–æ–¥–µ: <strong>" . $deck->getCount() . "</strong></p>";
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–∞—Ä—Ç
    if ($deck->getCount() === 52) {
        echo "<p class='success'>‚úÖ –ö–æ–ª–æ–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç (52)</p>";
    } else {
        echo "<p class='error'>‚ùå –û—à–∏–±–∫–∞: –∫–æ–ª–æ–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç " . $deck->getCount() . " –∫–∞—Ä—Ç –≤–º–µ—Å—Ç–æ 52</p>";
    }
    
    echo "<h3>var_dump –ø–µ—Ä–≤—ã—Ö 5 –∫–∞—Ä—Ç:</h3>";
    echo "<pre>";
    $cards = $deck->getCards();
    var_dump(array_slice($cards, 0, 5)); # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 5 –∫–∞—Ä—Ç –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏
    echo "</pre>";
    ?>
</div>

<div class="test-section">
    <h2>–¢–µ—Å—Ç 2: shuffle() - –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ –∫–æ–ª–æ–¥—ã</h2>
    <?php
    echo "<p>–ü–µ—Ä–≤—ã–µ 3 –∫–∞—Ä—Ç—ã –î–û –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è:</p>";
    $cards_before = $deck->getCards();
    echo "<ul>";
    for ($i = 0; $i < 3; $i++) {
        echo "<li>" . $cards_before[$i] . "</li>";
    }
    echo "</ul>";
    
    $deck->shuffle();
    $cards_after = $deck->getCards();
    
    echo "<p>–ü–µ—Ä–≤—ã–µ 3 –∫–∞—Ä—Ç—ã –ü–û–°–õ–ï –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è:</p>";
    echo "<ul>";
    for ($i = 0; $i < 3; $i++) {
        echo "<li>" . $cards_after[$i] . "</li>";
    }
    echo "</ul>";
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ—Ä—è–¥–æ–∫ –∏–∑–º–µ–Ω–∏–ª—Å—è
    $changed = false;
    for ($i = 0; $i < 3; $i++) {
        if ($cards_before[$i]->rank !== $cards_after[$i]->rank || 
            $cards_before[$i]->suit !== $cards_after[$i]->suit) {
            $changed = true;
            break;
        }
    }
    
    if ($changed) {
        echo "<p class='success'>–ö–æ–ª–æ–¥–∞ —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–º–µ—à–∞–Ω–∞</p>";
    } else {
        echo "<p>–ü–æ—Ä—è–¥–æ–∫ –∫–∞—Ä—Ç –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è (–º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å)</p>";
    }
    ?>
</div>

<div class="test-section">
    <h2>–¢–µ—Å—Ç 3: draw() - –≤—ã—Ç—è–≥–∏–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–π –∫–∞—Ä—Ç—ã</h2>
    <?php
    $cards_before_draw = $deck->getCount();
    echo "<p>–ö–∞—Ä—Ç –≤ –∫–æ–ª–æ–¥–µ –î–û draw(): <strong>$cards_before_draw</strong></p>";
    
    $drawn_card = $deck->draw();
    $cards_after_draw = $deck->getCount();
    
    echo "<p>–í—ã—Ç—è–Ω—É—Ç–∞—è –∫–∞—Ä—Ç–∞: <strong>$drawn_card</strong></p>";
    echo "<p>–ö–∞—Ä—Ç –≤ –∫–æ–ª–æ–¥–µ –ü–û–°–õ–ï draw(): <strong>$cards_after_draw</strong></p>";
    
    if ($cards_after_draw === $cards_before_draw - 1) {
        echo "<p class='success'>–ö–∞—Ä—Ç–∞ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞ –∏–∑ –∫–æ–ª–æ–¥—ã</p>";
    } else {
        echo "<p class='error'>–û—à–∏–±–∫–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç –Ω–µ —É–º–µ–Ω—å—à–∏–ª–æ—Å—å</p>";
    }
    
    echo "<h3>var_dump –≤—ã—Ç—è–Ω—É—Ç–æ–π –∫–∞—Ä—Ç—ã:</h3>";
    echo "<pre>";
    var_dump($drawn_card);
    echo "</pre>";
    ?>
</div>

<div class="test-section">
    <h2>–¢–µ—Å—Ç 4: calculateHandScore –¥–ª—è [Ace,10] = 21</h2>
    <?php
    /**
     * –¢–ï–°–¢ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –æ—á–∫–æ–≤ –¥–ª—è –±–ª—ç–∫–¥–∂–µ–∫–∞
     * 
     * –¶–µ–ª—å: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å—á–µ—Ç–∞ –æ—á–∫–æ–≤ –¥–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π
     * –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –±–ª—ç–∫–¥–∂–µ–∫–∞ - —Ç—É–∑ + –∫–∞—Ä—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å—é 10 –æ—á–∫–æ–≤.
     * 
     * –õ–æ–≥–∏–∫–∞ —Ç–µ—Å—Ç–∞:
     * - –¢—É–∑ –¥–æ–ª–∂–µ–Ω —Å—á–∏—Ç–∞—Ç—å—Å—è –∫–∞–∫ 11 (–Ω–µ –∫–∞–∫ 1)
     * - –î–µ—Å—è—Ç–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å—á–∏—Ç–∞—Ç—å—Å—è –∫–∞–∫ 10
     * - –ò—Ç–æ–≥–æ: 11 + 10 = 21 (–±–ª—ç–∫–¥–∂–µ–∫)
     * 
     * –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 21 –æ—á–∫–æ
     */
    $ace = new Card('hearts', 'A');    # –¢—É–∑ —á–µ—Ä–≤–µ–π (–±–∞–∑–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ 11)
    $ten = new Card('spades', '10');   # –î–µ—Å—è—Ç–∫–∞ –ø–∏–∫ (–∑–Ω–∞—á–µ–Ω–∏–µ 10)
    $test_hand = [$ace, $ten];         # –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –±–ª—ç–∫–¥–∂–µ–∫–∞
    
    echo "<p>–†—É–∫–∞: [<strong>$ace</strong>, <strong>$ten</strong>]</p>";
    
    # –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞—Å—á–µ—Ç–∞ –æ—á–∫–æ–≤
    $score = gameLogic::calculateHandScore($test_hand);
    echo "<p>–û—á–∫–∏ —Ä—É–∫–∏: <strong>$score</strong></p>";
    echo "<p>–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: <strong>21</strong></p>";
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    if ($score === 21) {
        echo "<p class='success'>‚úÖ –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù: –†–∞—Å—á—ë—Ç –æ—á–∫–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω!</p>";
    } else {
        echo "<p class='error'>‚ùå –¢–ï–°–¢ –ü–†–û–í–ê–õ–ï–ù: –ü–æ–ª—É—á–µ–Ω–æ $score –æ—á–∫–æ–≤ –≤–º–µ—Å—Ç–æ 21</p>";
    }
    
    echo "<h3>var_dump —Ç–µ—Å—Ç–æ–≤–æ–π —Ä—É–∫–∏:</h3>";
    echo "<pre>";
    var_dump($test_hand); # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ–±—ä–µ–∫—Ç–æ–≤ –∫–∞—Ä—Ç
    echo "</pre>";
    
    echo "<h3>var_dump —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ calculateHandScore:</h3>";
    echo "<pre>";
    var_dump($score); # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–∏–ø –∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    echo "</pre>";
    ?>
</div>

<div class="test-section">
    <h2>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã</h2>
    
    <h3>–¢–µ—Å—Ç —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ç—É–∑–∞–º–∏:</h3>
    <?php
    $ace1 = new Card('hearts', 'A');
    $ace2 = new Card('spades', 'A'); 
    $nine = new Card('clubs', '9');
    $multi_ace_hand = [$ace1, $ace2, $nine];
    $multi_ace_score = gameLogic::calculateHandScore($multi_ace_hand);
    
    echo "<p>–†—É–∫–∞ [A‚ô•, A‚ô†, 9‚ô£]: <strong>$multi_ace_score –æ—á–∫–æ–≤</strong></p>";
    echo "<p>–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 21 (11+1+9)</p>";
    
    if ($multi_ace_score === 21) {
        echo "<p class='success'>–¢—É–∑—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</p>";
    } else {
        echo "<p class='error'>–û—à–∏–±–∫–∞ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ç—É–∑–æ–≤</p>";
    }
    ?>
    
    <h3>–¢–µ—Å—Ç —Å –ø–µ—Ä–µ–±–æ—Ä–æ–º:</h3>
    <?php
    $king = new Card('hearts', 'K');
    $queen = new Card('spades', 'Q');
    $five = new Card('clubs', '5');
    $bust_hand = [$king, $queen, $five];
    $bust_score = gameLogic::calculateHandScore($bust_hand);
    
    echo "<p>–†—É–∫–∞ [K‚ô•, Q‚ô†, 5‚ô£]: <strong>$bust_score –æ—á–∫–æ–≤</strong></p>";
    echo "<p>–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 25 (–ø–µ—Ä–µ–±–æ—Ä)</p>";
    
    if ($bust_score === 25) {
        echo "<p class='success'>–ü–µ—Ä–µ–±–æ—Ä —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</p>";
    } else {
        echo "<p class='error'>–û—à–∏–±–∫–∞ –≤ —Ä–∞—Å—á—ë—Ç–µ –ø–µ—Ä–µ–±–æ—Ä–∞</p>";
    }
    ?>
</div>

<div class="test-section" style="background-color: #e8f5e8; border-color: #4caf50;">
    <h2>üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
    <p><strong>–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã!</strong></p>
    <p>–ö–ª–∞—Å—Å Card —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</p>
    <p>–ö–ª–∞—Å—Å Deck —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</p>
    <p>–§—É–Ω–∫—Ü–∏—è calculateHandScore —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</p>
    <p>–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—É–∑–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ</p>
    <p><strong>–û—à–∏–±–æ–∫ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ!</strong></p>
</div>

</body>
</html>